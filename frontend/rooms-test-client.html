<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ChatFlow - Authenticated Client</title>
    <link rel="stylesheet" href="styles.css" />
  </head>

  <body>
    <div class="app">
      <!-- Authentication Screen -->
      <div class="auth-screen" id="auth-screen">
        <div class="auth-container">
          <h1>ðŸš€ Chat Flow</h1>
          <div class="error-message" id="auth-error"></div>
          <div class="auth-tabs">
            <button class="auth-tab active" data-tab="login">Login</button>
            <button class="auth-tab" data-tab="register">Register</button>
          </div>

          <!-- Login Form -->
          <form class="auth-form active" id="login-form">
            <div class="form-group">
              <label>Username or Email</label>
              <input
                type="text"
                id="login-username"
                required
                autocomplete="username"
              />
            </div>
            <div class="form-group">
              <label>Password</label>
              <input
                type="password"
                id="login-password"
                required
                autocomplete="current-password"
              />
            </div>
            <button type="submit" class="auth-btn" id="login-btn">Login</button>
          </form>

          <!-- Register Form -->
          <form class="auth-form" id="register-form">
            <div class="form-group">
              <label>Username</label>
              <input
                type="text"
                id="register-username"
                required
                autocomplete="username"
              />
            </div>
            <div class="form-group">
              <label>Email</label>
              <input
                type="email"
                id="register-email"
                required
                autocomplete="email"
              />
            </div>
            <div class="form-group">
              <label>Password</label>
              <input
                type="password"
                id="register-password"
                required
                autocomplete="new-password"
                minlength="8"
              />
            </div>
            <div class="form-group">
              <label>Display Name (optional)</label>
              <input
                type="text"
                id="register-display-name"
                autocomplete="name"
              />
            </div>
            <button type="submit" class="auth-btn" id="register-btn">
              Register
            </button>
          </form>
        </div>
      </div>

      <!-- Chat Screen -->
      <div id="chat-screen" class="chat-screen">
        <!-- Sidebar -->
        <div class="sidebar">
          <div class="sidebar-header">
            <h2>ChatFlow</h2>
            <div class="user-info" id="current-user-info"></div>
          </div>

          <div class="sidebar-content">
            <!-- My Rooms -->
            <div class="sidebar-section">
              <div class="sidebar-section-title">
                <span>My Rooms</span>
                <button id="create-room-btn" title="Create Room">+</button>
              </div>
              <ul class="room-list" id="my-rooms-list">
                <li class="empty-state-subtext" style="padding: 10px">
                  No rooms yet
                </li>
              </ul>
            </div>

            <!-- Public Rooms -->
            <div class="sidebar-section">
              <div class="sidebar-section-title">
                <span>Public Rooms</span>
                <button id="refresh-rooms-btn" title="Refresh">â†»</button>
              </div>
              <ul class="room-list" id="public-rooms-list">
                <li class="empty-state-subtext" style="padding: 10px">
                  Loading...
                </li>
              </ul>
            </div>

            <!-- Online Users -->
            <div class="sidebar-section">
              <div class="sidebar-section-title">
                <span>Online Users</span>
              </div>
              <ul class="user-list" id="online-users-list">
                <li class="empty-state-subtext" style="padding: 10px">
                  No users online
                </li>
              </ul>
            </div>
          </div>

          <div class="sidebar-footer">
            <button class="logout-btn" id="logout-btn">Logout</button>
          </div>
        </div>

        <!-- Main Chat Area -->
        <div class="main-chat">
          <div class="chat-header">
            <div>
              <h3 id="chat-title">Select a room or user</h3>
              <div class="chat-header-subtitle" id="chat-subtitle"></div>
            </div>
            <div class="status-indicator disconnected" id="connection-status">
              Disconnected
            </div>
          </div>

          <div class="messages-container" id="messages-container">
            <div class="empty-state">
              <div class="empty-state-icon">ðŸ’¬</div>
              <div class="empty-state-text">Welcome to ChatFlow!</div>
              <div class="empty-state-subtext">
                Select a room or start a direct message
              </div>
            </div>
          </div>

          <div class="message-input-container">
            <div class="message-input-wrapper">
              <textarea
                id="message-input"
                class="message-input"
                placeholder="Type a message..."
                rows="1"
                disabled
              ></textarea>
              <button class="send-btn" id="send-btn" disabled>Send</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Create Room Modal -->
    <div class="modal" id="create-room-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Create Room</h3>
          <button class="modal-close" id="close-create-room">Ã—</button>
        </div>
        <form id="create-room-form">
          <div class="form-group">
            <label>Room Name (URL-friendly)</label>
            <input
              type="text"
              id="room-name"
              required
              pattern="[a-z0-9-]+"
              placeholder="general-chat"
              title="Only lowercase letters, numbers, and hyphens"
            />
          </div>
          <div class="form-group">
            <label>Display Name</label>
            <input
              type="text"
              id="room-display-name"
              required
              placeholder="General Chat"
            />
          </div>
          <div class="form-group">
            <label>Description (optional)</label>
            <input
              type="text"
              id="room-description"
              placeholder="A place for general discussion"
            />
          </div>
          <button type="submit" class="auth-btn">Create Room</button>
        </form>
      </div>
    </div>

    <!-- Socket.io client library -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>

    <script type="module" src="./js/app.js"></script>
  </body>
</html>
